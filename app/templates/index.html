{% extends "base.html" %}
{% block title %}Dashboard - You Temp{% endblock %}

{% block content %}
<h2>All Sensors</h2>

<table border="0" cellpadding="10">
<thead>
<tr>
    <th>Name</th>
    <th>UUID</th>
    <th>Owner</th>
    <th>Last Temperature</th>
</tr>
</thead>
<tbody id="sensor-table"></tbody>
</table>

<script>
async function loadSensors() {
    const res = await fetch('/api/sensors');
    const data = await res.json();

    const tbody = document.getElementById('sensor-table');
    tbody.innerHTML = '';

    data.forEach(s => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${s.name}</td>
            <td>${s.uuid}</td>
            <td>${s.username}</td>
            <td>${s.temperature ?? '-'}</td>
        `;
        tbody.appendChild(tr);
    });
}

loadSensors();
setInterval(loadSensors, 1000);
</script>
{% endblock %}
